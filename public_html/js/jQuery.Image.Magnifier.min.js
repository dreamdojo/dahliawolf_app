(function(a){a.fn.jim=function(b){var c=a.extend({width:180,height:180,orientation:0,padding:5,animate:false,rounded:false,shadow:true,border:true,stopOnEdges:false},b);return this.each(function(){var e=a(this);a(this).data("settings",c);a(this).load(function(){e.data("width",Math.round(e.innerWidth()));e.data("height",Math.round(e.innerHeight()))});if(a(this).data("settings").orientation<0||a(this).data("settings").orientation>4){a(this).data("settings").orientation=0}if(a(this).data("settings").orientation==0&&a(this).data("settings").width>a(this).data("width")){a(this).data("settings").height=a(this).data("width")}if(a(this).data("settings").orientation==0&&a(this).data("settings").height>a(this).data("height")){a(this).data("settings").height=a(this).data("height")}if(a(this).attr("longdesc")){a(this).data("magnifiedImageSrc",a(this).attr("longdesc"))}else{a(this).data("magnifiedImageSrc",a(this).attr("src"))}var d=new Image();d.src=a(this).data("magnifiedImageSrc");a(d).load(function(){e.data("magnifiedImageWidth",d.width?d.width:a(d).context.width);e.data("magnifiedImageHeight",d.height?d.height:a(d).context.height)});a(this).data("rndId","jim-container-"+Math.round(Math.random()*100000));a(this).mouseenter(function(f){e.data("top",Math.round(e.position().top+parseInt(e.css("margin-top"))));e.data("left",Math.round(e.position().left+parseInt(e.css("margin-left"))));a("body").append('<div class="jim-container" id="'+e.data("rndId")+'"></div>');a("#"+e.data("rndId")).append('<div class="jim-container-inner"></div>');a("#"+e.data("rndId")).append('<div class="jim-cursor"></div>');if(a(this).data("settings").orientation==0&&e.data("width")!=e.data("settings").width&&e.data("height")!=e.data("settings").height){a("#"+e.data("rndId")).addClass("jim-nocursor")}else{a("#"+e.data("rndId")).addClass("jim-zoom")}if(e.data("settings").rounded){a("#"+e.data("rndId")+" .jim-cursor").addClass("c-rounded")}if(e.data("settings").shadow){a("#"+e.data("rndId")+" .jim-cursor").addClass("c-shadow")}if(e.data("settings").border){a("#"+e.data("rndId")+" .jim-cursor").addClass("c-border")}a("#"+e.data("rndId")).css({width:e.data("width"),height:e.data("height"),top:e.data("top"),left:e.data("left")});a("#"+e.data("rndId")+" .jim-container-inner").css({width:e.data("width"),height:e.data("height")});a("#"+e.data("rndId")+" .jim-cursor").css({width:e.data("settings").width,height:e.data("settings").height});a("#"+e.data("rndId")+" .jim-cursor").css({"background-image":'url("'+e.data("magnifiedImageSrc")+'")',"background-repeat":"no-repeat"});if(e.data("settings").orientation==0){a("#"+e.data("rndId")+" .jim-cursor").css({top:0,left:0})}else{if(e.data("settings").orientation==1){a("#"+e.data("rndId")+" .jim-cursor").css({top:0-e.data("settings").padding-e.data("settings").height,left:0})}else{if(e.data("settings").orientation==2){a("#"+e.data("rndId")+" .jim-cursor").css({top:0,left:0+e.data("settings").padding+e.data("width")})}else{if(e.data("settings").orientation==3){a("#"+e.data("rndId")+" .jim-cursor").css({top:0+e.data("settings").padding+e.data("height"),left:0})}else{if(e.data("settings").orientation==4){a("#"+e.data("rndId")+" .jim-cursor").css({top:0,left:0-e.data("settings").padding-e.data("width")})}}}}}a("#"+e.data("rndId")).mouseleave(function(g){a("#"+e.data("rndId")).remove()});a("#"+e.data("rndId")).mousemove(function(g){if(e.data("settings").orientation==0){if(e.data("settings").stopOnEdges){if(g.pageY<e.data("top")+Math.round(e.data("settings").height/2)){calculatedTop=0}else{if(g.pageY>e.data("top")+e.data("height")-Math.round(e.data("settings").height/2)){calculatedTop=e.data("height")-e.data("settings").height}else{calculatedTop=g.pageY-e.data("top")-Math.round(e.data("settings").height/2)}}if(g.pageX<e.data("left")+Math.round(e.data("settings").width/2)){calculatedLeft=0}else{if(g.pageX>e.data("left")+e.data("width")-Math.round(e.data("settings").width/2)){calculatedLeft=e.data("width")-e.data("settings").width}else{calculatedLeft=g.pageX-e.data("left")-Math.round(e.data("settings").width/2)}}}else{calculatedTop=g.pageY-e.data("top")-Math.round(e.data("settings").height/2);calculatedLeft=g.pageX-e.data("left")-Math.round(e.data("settings").width/2)}a("#"+e.data("rndId")+" .jim-cursor").css({top:calculatedTop,left:calculatedLeft})}ratioX=e.data("magnifiedImageWidth")/e.data("width");ratioY=e.data("magnifiedImageHeight")/e.data("height");backgroundPositionX=-((g.pageX-e.data("left"))*ratioX-e.data("settings").width/2);backgroundPositionY=-((g.pageY-e.data("top"))*ratioY-e.data("settings").height/2);if(e.data("settings").stopOnEdges){if(backgroundPositionX>0){backgroundPositionX=0}else{if(e.data("magnifiedImageWidth")+backgroundPositionX<=e.data("settings").width){backgroundPositionX=-(e.data("magnifiedImageWidth")-e.data("settings").width)}}if(backgroundPositionY>0){backgroundPositionY=0}else{if(e.data("magnifiedImageHeight")+backgroundPositionY<=e.data("settings").height){backgroundPositionY=-(e.data("magnifiedImageHeight")-e.data("settings").height)}}}backgroundPosition=backgroundPositionX+"px "+backgroundPositionY+"px";a("#"+e.data("rndId")+" .jim-cursor").css({backgroundPosition:backgroundPosition});if(g.pageY>e.data("top")+e.data("height")||g.pageX>e.data("left")+e.data("width")||g.pageY<e.data("top")||g.pageX<e.data("left")){a("#"+e.data("rndId")).remove()}});a("#"+e.data("rndId")+" .jim-cursor").mousemove();if(e.data("settings").animate){a("#"+e.data("rndId")+" .jim-cursor").fadeIn(250)}else{a("#"+e.data("rndId")+" .jim-cursor").show()}})})}})(jQuery);